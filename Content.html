<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorting Visualizer </title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: #755d71;
  color: white;
  text-align: center;
  margin: 0;
  padding: 0;
}
h1 { margin-top: 15px; }

.controls {
  margin: 10px auto;
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
}
button, input, select {
  background: #333333;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 5px;
  font-size: 14px;
  cursor: pointer;
}
button:hover, select:hover { background: #555; }

#arrayContainer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 6px;
  width: 90%;
  margin: 20px auto;
  background: #555b3f;
  padding: 15px;
  border-radius: 10px;
  min-height: 160px;
}

.box {
  width: 45px;
  height: 45px;
  background: rgb(123, 158, 158);
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  font-weight: bold;
  font-size: 16px;
  transition: transform 0.3s, background 0.3s;
}

.highlight { background: orange !important; color: black; transform: scale(1.1); }
.swap { background: red !important; color: white; transform: rotate(10deg); }
.sorted { background: lime !important; color: black; transform: scale(1.1); }

.info { margin-top: 10px; }

pre {
  text-align: left;
  margin: 20px auto;
  background: #111;
  color: #ccc;
  padding: 10px;
  border-radius: 8px;
  width: 90%;
  overflow-x: auto;
}
.highlight-line {
  background-color: rgba(255, 255, 0, 0.2);
}

/* ðŸŽ‰ Completion animation */
@keyframes wave {
  0%, 100% { transform: scale(1); background: lime; }
  50% { transform: scale(1.3); background: yellow; }
}
@keyframes fadeInOut {
  0% { opacity: 0; transform: scale(0.8); }
  50% { opacity: 1; transform: scale(1.1); }
  100% { opacity: 0; transform: scale(0.8); }
}
#completeMessage {
  font-size: 24px;
  color: #00ffcc;
  opacity: 0;
  animation: fadeInOut 3s ease forwards;
  margin-top: 15px;
}
</style>
</head>
<body>

<h1>Sorting Algorithm Visualizer</h1>

<div class="controls">
  <input type="text" id="userInput" placeholder="Enter numbers e.g. 5,2,9,1">
  <button id="generate">Generate Boxes</button>
  <select id="algorithm">
      <option value="bubble">Bubble Sort</option>
      <option value="selection">Selection Sort</option>
      <option value="insertion">Insertion Sort</option>
      <option value="merge">Merge Sort</option>
      <option value="quick">Quick Sort</option>
  </select>
  <label>Speed: <input type="range" id="speed" min="10" max="1000" value="300"></label>
  <button id="start">Start</button>
  <button id="pause">Pause</button>
  <button id="reset">Reset</button>
</div>

<div id="arrayContainer"></div>

<div class="info">
  Comparisons: <span id="comparisons">0</span> |
  Time Complexity: <span id="complexity">O(nÂ²)</span>
</div>

<pre id="codeDisplay">// Algorithm code will appear here</pre>
<div id="completeMessage"></div>

<audio id="compareSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="swapSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

<script>
let array = [];
let boxes = [];
let comparisons = 0;
let isPaused = false;
let isStopped = false;
let speed = 300;

const arrayContainer = document.getElementById("arrayContainer");
const comparisonsDisplay = document.getElementById("comparisons");
const complexityDisplay = document.getElementById("complexity");
const compareSound = document.getElementById("compareSound");
const swapSound = document.getElementById("swapSound");
const codeDisplay = document.getElementById("codeDisplay");
const completeMessage = document.getElementById("completeMessage");

// ===== Utility =====
function generateArrayFromInput() {
  const input = document.getElementById("userInput").value.trim();
  if (!input) return alert("Please enter numbers separated by commas.");
  array = input.split(",").map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  if (array.length === 0) return alert("Invalid input! Use numbers separated by commas.");
  displayArray();
}

function displayArray() {
  arrayContainer.innerHTML = "";
  comparisons = 0;
  comparisonsDisplay.textContent = 0;
  completeMessage.style.opacity = 0;
  array.forEach(value => {
    const box = document.createElement("div");
    box.classList.add("box");
    box.textContent = value;
    arrayContainer.appendChild(box);
  });
  boxes = document.querySelectorAll(".box");
}

function sleep(ms) { return new Promise(res => setTimeout(res, ms)); }

function highlightLine(lineNumber) {
  document.querySelectorAll("pre span").forEach(span => span.classList.remove("highlight-line"));
  document.getElementById(`line${lineNumber}`)?.classList.add("highlight-line");
}

function setCode(lines) {
  codeDisplay.innerHTML = lines.map((l, i) => `<span id="line${i+1}">${l}</span>`).join("\n");
}

function swap(i, j) {
  [array[i], array[j]] = [array[j], array[i]];
  [boxes[i].textContent, boxes[j].textContent] = [array[i], array[j]];
  boxes[i].classList.add("swap");
  boxes[j].classList.add("swap");
  swapSound.currentTime = 0;
  swapSound.play();
  setTimeout(() => {
    boxes[i].classList.remove("swap");
    boxes[j].classList.remove("swap");
  }, speed);
}

async function highlightCompare(i, j) {
  boxes[i].classList.add("highlight");
  boxes[j].classList.add("highlight");
  compareSound.currentTime = 0;
  compareSound.play();
  await sleep(speed);
  boxes[i].classList.remove("highlight");
  boxes[j].classList.remove("highlight");
  comparisons++;
  comparisonsDisplay.textContent = comparisons;
}

// ====== Sorting Algorithms ======
const algorithms = {
  bubble: {
    code: [
      "for i in range(0, n-1):",
      "  for j in range(0, n-i-1):",
      "    if arr[j] > arr[j+1]:",
      "       swap(arr[j], arr[j+1])"
    ],
    run: async function() {
      complexityDisplay.textContent = "O(nÂ²)";
      const n = array.length;
      for (let i = 0; i < n - 1; i++) {
        highlightLine(1);
        for (let j = 0; j < n - i - 1; j++) {
          if (isStopped) return;
          while (isPaused) await sleep(100);
          highlightLine(2);
          await highlightCompare(j, j + 1);
          if (array[j] > array[j + 1]) {
            highlightLine(3);
            swap(j, j + 1);
            await sleep(speed);
          }
        }
        boxes[n - i - 1].classList.add("sorted");
      }
      boxes[0].classList.add("sorted");
    }
  },
  selection: {
    code: [
      "for i in range(0, n-1):",
      "   min_index = i",
      "   for j in range(i+1, n):",
      "      if arr[j] < arr[min_index]: min_index = j",
      "   swap(arr[i], arr[min_index])"
    ],
    run: async function() {
      complexityDisplay.textContent = "O(nÂ²)";
      const n = array.length;
      for (let i = 0; i < n; i++) {
        let min = i;
        highlightLine(2);
        for (let j = i + 1; j < n; j++) {
          if (isStopped) return;
          while (isPaused) await sleep(100);
          highlightLine(3);
          await highlightCompare(j, min);
          if (array[j] < array[min]) {
            highlightLine(4);
            min = j;
          }
        }
        highlightLine(5);
        swap(i, min);
        await sleep(speed);
        boxes[i].classList.add("sorted");
      }
    }
  },
  insertion: {
    code: [
      "for i in range(1, n):",
      "   key = arr[i]",
      "   j = i - 1",
      "   while j >= 0 and arr[j] > key:",
      "       arr[j+1] = arr[j]",
      "       j -= 1",
      "   arr[j+1] = key"
    ],
    run: async function() {
      complexityDisplay.textContent = "O(nÂ²)";
      const n = array.length;
      for (let i = 1; i < n; i++) {
        highlightLine(1);
        let key = array[i];
        let j = i - 1;
        while (j >= 0 && array[j] > key) {
          if (isStopped) return;
          while (isPaused) await sleep(100);
          highlightLine(4);
          await highlightCompare(j, i);
          array[j + 1] = array[j];
          boxes[j + 1].textContent = array[j + 1];
          await sleep(speed);
          j--;
        }
        highlightLine(7);
        array[j + 1] = key;
        boxes[j + 1].textContent = key;
      }
      boxes.forEach(b => b.classList.add("sorted"));
    }
  },
  merge: {
    code: [
      "def merge_sort(arr):",
      "  if len(arr) > 1:",
      "     mid = len(arr)//2",
      "     left = arr[:mid]",
      "     right = arr[mid:]",
      "     merge_sort(left)",
      "     merge_sort(right)",
      "     merge(left, right)"
    ],
    run: async function mergeSort(start = 0, end = array.length - 1) {
      complexityDisplay.textContent = "O(n log n)";
      if (start >= end) return;
      const mid = Math.floor((start + end) / 2);
      await mergeSort(start, mid);
      await mergeSort(mid + 1, end);
      await merge(start, mid, end);
    }
  },
  quick: {
    code: [
      "def quick_sort(arr, low, high):",
      "  if low < high:",
      "     pi = partition(arr, low, high)",
      "     quick_sort(arr, low, pi-1)",
      "     quick_sort(arr, pi+1, high)"
    ],
    run: async function quickSort(low = 0, high = array.length - 1) {
      complexityDisplay.textContent = "O(n log n)";
      if (low < high) {
        const pi = await partition(low, high);
        await quickSort(low, pi - 1);
        await quickSort(pi + 1, high);
      } else if (low >= 0 && high >= 0 && low < array.length && high < array.length) {
        boxes[low].classList.add("sorted");
      }
    }
  }
};

// ====== Merge + Quick helpers ======
async function merge(start, mid, end) {
  let left = array.slice(start, mid + 1);
  let right = array.slice(mid + 1, end + 1);
  let i = 0, j = 0, k = start;
  while (i < left.length && j < right.length) {
    if (isStopped) return;
    while (isPaused) await sleep(100);
    await highlightCompare(start + i, mid + 1 + j);
    if (left[i] <= right[j]) array[k] = left[i++];
    else array[k] = right[j++];
    boxes[k].textContent = array[k];
    swapSound.play();
    await sleep(speed);
    k++;
  }
  while (i < left.length) array[k] = left[i++], boxes[k++].textContent = array[k - 1];
  while (j < right.length) array[k] = right[j++], boxes[k++].textContent = array[k - 1];
}

async function partition(low, high) {
  let pivot = array[high];
  boxes[high].classList.add("highlight");
  let i = low - 1;
  for (let j = low; j < high; j++) {
    if (isStopped) return;
    while (isPaused) await sleep(100);
    await highlightCompare(j, high);
    if (array[j] < pivot) {
      i++;
      swap(i, j);
      await sleep(speed);
    }
  }
  swap(i + 1, high);
  boxes[high].classList.remove("highlight");
  boxes[i + 1].classList.add("sorted");
  return i + 1;
}

// ====== Completion Animation ======
async function showCompletion() {
  for (let i = 0; i < boxes.length; i++) {
    boxes[i].style.animation = `wave 0.5s ease ${i * 0.1}s`;
  }
  completeMessage.textContent = "ðŸŽ‰ Sorting Completed!";
  completeMessage.style.opacity = 1;
}

// ====== Events ======
document.getElementById("generate").addEventListener("click", generateArrayFromInput);
document.getElementById("algorithm").addEventListener("change", e => {
  const algo = e.target.value;
  setCode(algorithms[algo].code);
});
document.getElementById("start").addEventListener("click", async () => {
  isPaused = false;
  isStopped = false;
  const algo = document.getElementById("algorithm").value;
  setCode(algorithms[algo].code);
  await algorithms[algo].run();
  boxes.forEach(b => b.classList.add("sorted"));
  await showCompletion();
});
document.getElementById("pause").addEventListener("click", () => { isPaused = !isPaused; });
document.getElementById("reset").addEventListener("click", () => { isStopped = true; displayArray(); });
document.getElementById("speed").addEventListener("input", e => { speed = 1000 - e.target.value; });
</script>
</body>
</html>
